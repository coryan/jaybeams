<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JayBeams: JayBeams Style Guide and Coding Standards</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JayBeams
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Another project to have fun coding.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">JayBeams Style Guide and Coding Standards </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Introduction</h2>
<p>This document describes the coding standards used in JayBeams, and the rationale behind them. If you disagree with the standard please open a issue in github and/or send a PR to change this document before changing the code.</p>
<h2>Header Files</h2>
<h3>All headers should be self-contained.</h3>
<p>One should be able to <code>#</code><code>include</code> a header and compile it without requiring any additional headers before or after.</p>
<h3>The <code>#</code>define Guard</h3>
<p>All headers should include a <code>#</code><code>ifndef/</code><code>#</code><code>define/</code><code>#</code><code>endif</code> guard. The guard must be the first line in the header. The name of the guard is constructed by the full path of the header file from the root of JayBeams, replacing both slashes (<code>/</code>) and period (<code>.</code>) characters by an underscore (<code>_</code>). For example, the include guard for <code>foo/bar/baz_qux.hpp</code> becomes <code>foo_bar_baz_qux_hpp</code>. There must be no double underscores in a guard name, that limits your options for filenames.</p>
<p><b>Example:</b> the <code>foo/bar/baz_qux.hpp</code> file <b>must</b> be protected by:</p>
<div class="fragment"><div class="line">{c++}</div><div class="line">#ifndef foo_bar_baz_qux_hpp</div><div class="line">#define foo_bar_baz_qux_hpp</div><div class="line">// ... your code here</div><div class="line">#endif // foo_bar_baz_qux_hpp</div></div><!-- fragment --><p><b>Rationale:</b> protecting against multiple includes is a standard C++ practice, we will not elaborate further. Making that the first line enables some compilers to optimize parsing of the header if it is already included. Making the name of the guard algorithmic removes a debate. Identifiers with double underscores are reserved for the implementation in POSIX, so we avoid them.</p>
<h3>Forward Declarations</h3>
<p>Use them when needed or they make sense.</p>
<h3>Inline Functions</h3>
<p>Single line functions should be inlined, virtual functions, even if single line, should not be inlined. Inline function should not be separate from the class definition.</p>
<p><b>Use:</b></p>
<div class="fragment"><div class="line">{c++}</div><div class="line">class foo {</div><div class="line">public:</div><div class="line">  inline int answer() const {</div><div class="line">    return 42;</div><div class="line">  }</div></div><!-- fragment --><p><b>Do Not Use:</b></p>
<div class="fragment"><div class="line">{c++}</div><div class="line">class foo {</div><div class="line">public:</div><div class="line">  int answer() const;</div><div class="line">};</div><div class="line">inline int Foo::answer() const {</div><div class="line">  return 42;</div><div class="line">}</div></div><!-- fragment --><p><b>Rationale:</b> We want to avoid function call overhead for trivial functions, but inlining rarely works for virtual functions. We want to minimize typing.</p>
<h3>Name of Includes</h3>
<p>The name of the include must match the name of the main class or function in the include. Define a single class per include, do not define many classes in the same header. Multiple function overloads can be included in the same header, but avoid many unrelated functions in the same header.</p>
<h3>Order of Includes</h3>
<p>The main include for a source file goes first. The includes in the same directory, then includes in JayBeams, then boost and other third-party libraries, then C++ libraries.</p>
<p>The order is enforced by clang-format, so we do not define it further, the tool does it for us.</p>
<p><b>Rationale:</b> Lakos' argument, we want to include the header early to detect missing dependencies as soon as possible.</p>
<h3>Namespaces</h3>
<p>Namespaces are also lowercase, with the path of the namespace matching the path of the files. So, for example, all classes and functions in the <code>jb::foo::bar</code> namespace must be defined in files contained by the <code>jb/foo/bar</code> directory.</p>
<p><b>Rationale:</b> we want to make it easy to find classes and functions.</p>
<h4>Exception: the <code>jb::*<a class="el" href="namespacedefaults.html" title="Define defaults for program parameters. ">defaults</a></code> namespaces</h4>
<p>JayBeams defines a series of namespaces containing default values for configuration parameters. The objects in these namespaces do not need a sub-directory.</p>
<p><b>Rationale:</b> the namespace simply defines a number of constants, typically used in a single <code>.cpp</code> file, creating a complete new directory for them is overkill.</p>
<h2>Naming Guidelines</h2>
<h3>Identifiers</h3>
<p>Identifiers use lowercase characters, with words separated by underscore characters. All global identifiers (except pre-processor macros) must be in the <code>jb::</code> namespace.</p>
<p><b>Rationale:</b> this is the naming adopted in the C++ standard and Boost. It used to be the case that uppercase names were "safer" for the application, because in implementations lacking namespaces the system or standard could introduce a conflicting name without warning.</p>
<h3>Function-like Macros</h3>
<p>In general JayBeams tries to not use macros, but they are sometimes the best (or only) way to implement a feature. Function-like macros should be named like functions, using lowercase characters with words separated by underscores.</p>
<h3>Object-like Macros</h3>
<p>The only object-like macros used in JayBeams are intended to set compile-time configurable parameters. Such macros are used in a single .cpp file, start with the path of the file in ALL CAPS, followed by the name of the constant in all lowercase.</p>
<p>For example, suppose a compile-time configurable parameter is called <code>max_slots</code> and is used in <code>jb/foo_bar/baz.cpp</code>, the macro name shall be <code>JB_FOO_BAR_BAZ_max_slots</code>.</p>
<h3>Filenames</h3>
<p>Filenames are all lowercase, no file can be longer than 128 bytes in length. The file name should match the name of the main class or function defined in the class.</p>
<p><b>Rationale:</b> This makes it easier to find the classes and functions. Always using lowercases avoid conflicts in operating systems that do not distinguish between uppercase and lowercase characters in filenames. Some modern operating systems impose limits on filename length <a href="https://en.wikipedia.org/wiki/Comparison_of_file_systems">ref</a></p>
<h3>No "util" Files</h3>
<p><b>Rationale:</b> Util files become hard to maintain and distinguish from each other, if you have standalone functions just create a separate pair of files for them.</p>
<h2>Use Exceptions Sparingly</h2>
<p>Exceptions should represent, well, exceptional conditions. Normal errors that we expect (e.g. missing files, closed sockets, etc) are not exceptional conditions and the API should include treatment for them.</p>
<p><b>Rationale:</b> this is the standard practice in C++, read "The Design
  and Evolution of C++".</p>
<h2>Aliases</h2>
<p>Use aliases to increase clarity, specially in template code where type traits are a common practice to improve readability and usability. Prefer the C++11 <code>using foo = bar;</code> aliases over the <code>typedef bar foo;</code> aliases.</p>
<p><b>Rationale:</b> The use of type aliases is a standard practice, we will not elaborate further. The use of <code>using</code> aliases vs. <code>typedef</code> aliases is for consistency: <code>using</code> is required for template aliases, so we use it everywhere.</p>
<h2>External Depedendencies</h2>
<p>JayBeams will prefer to use an external dependency over reimplementing significant functionality. Obviously there is a tradeoff for very small external dependencies, developers should apply their best judgement. As a guideline, external libraries that implement less than 100 lines of code are probably too uninteresting to depend on.</p>
<h3>Preferred Libraries</h3>
<p>JayBeams will prefer to use functionality from the standard C++ library when available. If not available, JayBeams will prefer to use libraries for <a href="http://www.boost.org">boost</a>. If neither the C++ standard nor Boost provide the desired functionality then the developers should describe the dependency and document the rationale for it in this document.</p>
<h4>FFTW Library</h4>
<p>Implement the Fast Fourier Transform (FFT) algorithm for modern CPUs, taking advantage of vectorized instructions and many other optimizations.</p>
<p><b>Rationale:</b> Largely grandfathered in. Has a good reputation as a fast FFT library.</p>
<h4>YAML-CPP Library</h4>
<p>Implement a <a href="http://www.yaml.org">YAML</a> parser for C++.</p>
<p><b>Rationale:</b> Largely grandfathered in.</p>
<h4>Boost.Compute Library</h4>
<p>Boost wrappers for OpenCL.</p>
<p><b>Rationale:</b> accepted into boost.org as of 1.61.0, though not included in many Linux distributions yet. Wanted better (safer, more expressive) wrappers than what OpenCL provides natively.</p>
<h4>clFFT Library</h4>
<p>A FFT library for OpenCL implemented by AMD.</p>
<p><b>Rationale:</b> Largely grandfathered in.</p>
<h2>Formatting and Whitespace</h2>
<p>JayBeams uses <a href="http://clang.llvm.org/docs/ClangFormat.html">clang-format</a> for low-level formatting issues. We use version 3.8 or higher to do the formatting. The configuration file is included with the source code.</p>
<p>Notice that the formatting prescribes the order of <code>#</code><code>include</code> directives. We follow the suggestions from Lakos: first include the main header file, then local files, the increasingly lower dependencies. The objective is to detect missing dependencies in the header files early. With <code>clang-format</code> the main header file must be labeled specially by using double quotes instead of angle brackets for the include directive. That is, please use <code>#</code><code>include "foo/bar/baz.h"</code> instead of <code>#</code><code>include &lt;foo/bar/baz.h&gt;</code>.</p>
<p><b>Rationale:</b> arguing about whitespace is not productive, let the robots do that. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
