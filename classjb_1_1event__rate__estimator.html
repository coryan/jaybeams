<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>JayBeams: jb::event_rate_estimator&lt; duration_t, counter_t &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JayBeams
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Another project to have fun coding.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacejb.html">jb</a></li><li class="navelem"><a class="el" href="classjb_1_1event__rate__estimator.html">event_rate_estimator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classjb_1_1event__rate__estimator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">jb::event_rate_estimator&lt; duration_t, counter_t &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Estimate event rates over a trailing measurement period.  
 <a href="classjb_1_1event__rate__estimator.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a2cc8967679f69b380ca94fa114e95cca"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="classjb_1_1event__rate__estimator.html#ad20c51ab72c5fc59da908f88d890d25d">counter_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#a2cc8967679f69b380ca94fa114e95cca">buckets</a></td></tr>
<tr class="separator:a2cc8967679f69b380ca94fa114e95cca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Type traits.</div></td></tr>
<tr class="memitem:a0c97464fbf1de7bc974b548b7bc35355"><td class="memItemLeft" align="right" valign="top">typedef duration_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a></td></tr>
<tr class="separator:a0c97464fbf1de7bc974b548b7bc35355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad20c51ab72c5fc59da908f88d890d25d"><td class="memItemLeft" align="right" valign="top">typedef counter_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#ad20c51ab72c5fc59da908f88d890d25d">counter_type</a></td></tr>
<tr class="separator:ad20c51ab72c5fc59da908f88d890d25d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1453f5c2aeaa4d5018692af9d72fc383"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#a1453f5c2aeaa4d5018692af9d72fc383">event_rate_estimator</a> (<a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a> measurement_period, <a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a> sampling_period=<a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a>(1))</td></tr>
<tr class="memdesc:a1453f5c2aeaa4d5018692af9d72fc383"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build an accumulator to estimate event rates.  <a href="#a1453f5c2aeaa4d5018692af9d72fc383">More...</a><br /></td></tr>
<tr class="separator:a1453f5c2aeaa4d5018692af9d72fc383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ba320b3e8d464b489c97be4a445df26"><td class="memTemplParams" colspan="2">template&lt;typename functor &gt; </td></tr>
<tr class="memitem:a8ba320b3e8d464b489c97be4a445df26"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#a8ba320b3e8d464b489c97be4a445df26">sample</a> (<a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a> ts, functor update)</td></tr>
<tr class="memdesc:a8ba320b3e8d464b489c97be4a445df26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Record a sample.  <a href="#a8ba320b3e8d464b489c97be4a445df26">More...</a><br /></td></tr>
<tr class="separator:a8ba320b3e8d464b489c97be4a445df26"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a99c48501816fb093ad1203aa13caf186"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#a99c48501816fb093ad1203aa13caf186">init</a> (<a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a> ts)</td></tr>
<tr class="memdesc:a99c48501816fb093ad1203aa13caf186"><td class="mdescLeft">&#160;</td><td class="mdescRight">Just initialize the circular buffer.  <a href="#a99c48501816fb093ad1203aa13caf186">More...</a><br /></td></tr>
<tr class="separator:a99c48501816fb093ad1203aa13caf186"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7b3216c92860f6908c167c75df01450"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#ab7b3216c92860f6908c167c75df01450">rotate</a> ()</td></tr>
<tr class="memdesc:ab7b3216c92860f6908c167c75df01450"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate the circular buffer.  <a href="#ab7b3216c92860f6908c167c75df01450">More...</a><br /></td></tr>
<tr class="separator:ab7b3216c92860f6908c167c75df01450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4a68f2927b01a23bfa3d1f4429c6fad"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#ab4a68f2927b01a23bfa3d1f4429c6fad">bucket_count</a> (<a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a> measurement_period, <a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a> sampling_period)</td></tr>
<tr class="memdesc:ab4a68f2927b01a23bfa3d1f4429c6fad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimate the necessary number of buckets.  <a href="#ab4a68f2927b01a23bfa3d1f4429c6fad">More...</a><br /></td></tr>
<tr class="separator:ab4a68f2927b01a23bfa3d1f4429c6fad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aa6ce1480ba40ec5a10f26273dbe9d866"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classjb_1_1event__rate__estimator.html#a2cc8967679f69b380ca94fa114e95cca">buckets</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#aa6ce1480ba40ec5a10f26273dbe9d866">buckets_</a></td></tr>
<tr class="memdesc:aa6ce1480ba40ec5a10f26273dbe9d866"><td class="mdescLeft">&#160;</td><td class="mdescRight">The time period is bucketized in intervals of 1 sampling period.  <a href="#aa6ce1480ba40ec5a10f26273dbe9d866">More...</a><br /></td></tr>
<tr class="separator:aa6ce1480ba40ec5a10f26273dbe9d866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58125a6314437b1424aded2b014034aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#a58125a6314437b1424aded2b014034aa">sampling_period_</a></td></tr>
<tr class="memdesc:a58125a6314437b1424aded2b014034aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">The sampling period.  <a href="#a58125a6314437b1424aded2b014034aa">More...</a><br /></td></tr>
<tr class="separator:a58125a6314437b1424aded2b014034aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4f620034a296eff4dd35f6bfef57af3"><td class="memItemLeft" align="right" valign="top">std::uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#ad4f620034a296eff4dd35f6bfef57af3">running_total_</a></td></tr>
<tr class="memdesc:ad4f620034a296eff4dd35f6bfef57af3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current number of events across all buckets.  <a href="#ad4f620034a296eff4dd35f6bfef57af3">More...</a><br /></td></tr>
<tr class="separator:ad4f620034a296eff4dd35f6bfef57af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49c0b84ce85a69da6c7727c1bd2c8d49"><td class="memItemLeft" align="right" valign="top">duration_type::rep&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#a49c0b84ce85a69da6c7727c1bd2c8d49">last_bucket_</a></td></tr>
<tr class="memdesc:a49c0b84ce85a69da6c7727c1bd2c8d49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current number for the sampling period.  <a href="#a49c0b84ce85a69da6c7727c1bd2c8d49">More...</a><br /></td></tr>
<tr class="separator:a49c0b84ce85a69da6c7727c1bd2c8d49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae79e32c2474047a2d003d8884207bb8c"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classjb_1_1event__rate__estimator.html#ae79e32c2474047a2d003d8884207bb8c">end_pos_</a></td></tr>
<tr class="memdesc:ae79e32c2474047a2d003d8884207bb8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">We treat the buckets as a circular buffer, this is the pointer to the end of the buffer.  <a href="#ae79e32c2474047a2d003d8884207bb8c">More...</a><br /></td></tr>
<tr class="separator:ae79e32c2474047a2d003d8884207bb8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt;<br />
class jb::event_rate_estimator&lt; duration_t, counter_t &gt;</h3>

<p>Estimate event rates over a trailing measurement period. </p>
<p>Assume you are interested in statistics about events per millisecond. This class estimates the number of events per trailing millisecond, using an arbitrary sampling period. For example, you could set the sampling period to 1 microsecond, this class would then estimate the event rate over the previous millisecond for every microsecond. Or you could set the sampling period to 1 millisecond, which would then estimate the event rate on each millisecond. Admittedly, for most practical purposes measuring event rates over an exact millisecond boundary or over a trailing millisecond has limited interest, but it was fun to write this class.</p>
<p>Given a <em>measurement_period:</em> the time over which we want to measure event rates, and <em>sampling_period:</em> how often we want to measure the event rates, the class keeps a circular buffer of N counters, representing the trailing sampling periods. N is chosen such that \( N &gt; {{measurement\_period} \over {sampling\_period}} \).</p>
<p>As new events arrive the counter for the current sampling period is incremented, once an event in a new sampling period is observed the class emits updates (via a functor) to update the estimated event rate.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">duration_t</td><td>Defines class used to measure time, this class must be compatible with std::chrono::duration_type. The class assumes that event timestamps are measured as durations with respect to some well-defined (by convention) epoch. For example, some data feeds use timestamps as nanoseconds since midnight, while others use timestamps as microseconds since the Unix Epoch. </td></tr>
    <tr><td class="paramname">counter_t</td><td>The type of the counters, most of the time a simple integer would work well, but if you need to create a large number of instances of this class, and the values are expected to be very small, you might consider using a 16-bit or even and 8-bit counter. Likewise, if you expect very large values for the counters, such as when measuring event rate per minute, you should consider using a 64-bit counter. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00058">58</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a2cc8967679f69b380ca94fa114e95cca"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="classjb_1_1event__rate__estimator.html#ad20c51ab72c5fc59da908f88d890d25d">counter_type</a>&gt; <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::<a class="el" href="classjb_1_1event__rate__estimator.html#a2cc8967679f69b380ca94fa114e95cca">buckets</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00146">146</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad20c51ab72c5fc59da908f88d890d25d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef counter_t <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::<a class="el" href="classjb_1_1event__rate__estimator.html#ad20c51ab72c5fc59da908f88d890d25d">counter_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00065">65</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0c97464fbf1de7bc974b548b7bc35355"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef duration_t <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::<a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00064">64</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a1453f5c2aeaa4d5018692af9d72fc383"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::<a class="el" href="classjb_1_1event__rate__estimator.html">event_rate_estimator</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a>&#160;</td>
          <td class="paramname"><em>measurement_period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a>&#160;</td>
          <td class="paramname"><em>sampling_period</em> = <code><a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a>(1)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build an accumulator to estimate event rates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">measurement_period</td><td>over what time period we want to measure message rates </td></tr>
    <tr><td class="paramname">sampling_period</td><td>how often do we want to measure message rates. Must be smaller than <em>measurement_period</em>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>if the measurement period is not a multiple of the sampling period. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00078">78</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ab4a68f2927b01a23bfa3d1f4429c6fad"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::bucket_count </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a>&#160;</td>
          <td class="paramname"><em>measurement_period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a>&#160;</td>
          <td class="paramname"><em>sampling_period</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Estimate the necessary number of buckets. </p>

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00169">169</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a99c48501816fb093ad1203aa13caf186"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a>&#160;</td>
          <td class="paramname"><em>ts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Just initialize the circular buffer. </p>

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00150">150</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

<p>Referenced by <a class="el" href="event__rate__estimator_8hpp_source.html#l00101">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::sample()</a>.</p>

</div>
</div>
<a class="anchor" id="ab7b3216c92860f6908c167c75df01450"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::rotate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate the circular buffer. </p>

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00158">158</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

<p>Referenced by <a class="el" href="event__rate__estimator_8hpp_source.html#l00101">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::sample()</a>.</p>

</div>
</div>
<a class="anchor" id="a8ba320b3e8d464b489c97be4a445df26"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
<div class="memtemplate">
template&lt;typename functor &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::sample </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a>&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">functor&#160;</td>
          <td class="paramname"><em>update</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Record a sample. </p>
<p>This class keeps the number of events observed over the last N sampling periods. New events in the same sampling period are simply recorded, but no rate estimate is made. When a timestamp in a new sampling period is required to record a sample, the <em>update()</em> functor is called to register the new measurements.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ts</td><td>the timestamp of the sample. </td></tr>
    <tr><td class="paramname">update</td><td>a functor to update when an event rate is estimated. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00101">101</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

<p>Referenced by <a class="el" href="ut__event__rate__estimator_8cpp_source.html#l00008">BOOST_AUTO_TEST_CASE()</a>, and <a class="el" href="event__rate__histogram_8hpp_source.html#l00096">jb::event_rate_histogram&lt; std::chrono::nanoseconds, std::int64_t &gt;::sample()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aa6ce1480ba40ec5a10f26273dbe9d866"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classjb_1_1event__rate__estimator.html#a2cc8967679f69b380ca94fa114e95cca">buckets</a> <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::buckets_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The time period is bucketized in intervals of 1 sampling period. </p>

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00213">213</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

<p>Referenced by <a class="el" href="event__rate__estimator_8hpp_source.html#l00150">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::init()</a>, <a class="el" href="event__rate__estimator_8hpp_source.html#l00158">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::rotate()</a>, and <a class="el" href="event__rate__estimator_8hpp_source.html#l00101">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::sample()</a>.</p>

</div>
</div>
<a class="anchor" id="ae79e32c2474047a2d003d8884207bb8c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::end_pos_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>We treat the buckets as a circular buffer, this is the pointer to the end of the buffer. </p>

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00226">226</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

<p>Referenced by <a class="el" href="event__rate__estimator_8hpp_source.html#l00150">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::init()</a>, <a class="el" href="event__rate__estimator_8hpp_source.html#l00158">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::rotate()</a>, and <a class="el" href="event__rate__estimator_8hpp_source.html#l00101">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::sample()</a>.</p>

</div>
</div>
<a class="anchor" id="a49c0b84ce85a69da6c7727c1bd2c8d49"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">duration_type::rep <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::last_bucket_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current number for the sampling period. </p>

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00222">222</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

<p>Referenced by <a class="el" href="event__rate__estimator_8hpp_source.html#l00150">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::init()</a>, <a class="el" href="event__rate__estimator_8hpp_source.html#l00158">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::rotate()</a>, and <a class="el" href="event__rate__estimator_8hpp_source.html#l00101">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::sample()</a>.</p>

</div>
</div>
<a class="anchor" id="ad4f620034a296eff4dd35f6bfef57af3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::uint64_t <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::running_total_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current number of events across all buckets. </p>

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00219">219</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

<p>Referenced by <a class="el" href="event__rate__estimator_8hpp_source.html#l00150">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::init()</a>, <a class="el" href="event__rate__estimator_8hpp_source.html#l00158">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::rotate()</a>, and <a class="el" href="event__rate__estimator_8hpp_source.html#l00101">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::sample()</a>.</p>

</div>
</div>
<a class="anchor" id="a58125a6314437b1424aded2b014034aa"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename duration_t = std::chrono::microseconds, typename counter_t = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classjb_1_1event__rate__estimator.html#a0c97464fbf1de7bc974b548b7bc35355">duration_type</a> <a class="el" href="classjb_1_1event__rate__estimator.html">jb::event_rate_estimator</a>&lt; duration_t, counter_t &gt;::sampling_period_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The sampling period. </p>

<p>Definition at line <a class="el" href="event__rate__estimator_8hpp_source.html#l00216">216</a> of file <a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a>.</p>

<p>Referenced by <a class="el" href="event__rate__estimator_8hpp_source.html#l00150">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::init()</a>, and <a class="el" href="event__rate__estimator_8hpp_source.html#l00101">jb::event_rate_estimator&lt; duration_type, rate_counter_type &gt;::sample()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>jb/<a class="el" href="event__rate__estimator_8hpp_source.html">event_rate_estimator.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
