<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JayBeams: How to Setup your Workstation to Compile JayBeams</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JayBeams
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Another project to have fun coding.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">How to Setup your Workstation to Compile JayBeams </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Introduction</h2>
<p>These are my notes on how to prepare your environment to build JayBeams. If you find a problem with the instructions, please submit a patch or file a bug.</p>
<p>The continuous integration builds for JayBeams run inside <a href="https://docker.io">docker</a>, a single Dockerfile installs all necessary dependencies, compiles them, then compiles the code, runs the tests, verifies that the install rules work as expected and (in some cases), even verify that the code is formatted properly.</p>
<p>It is possible to use the same docker file to build your copy of the code, and this is probably the most reliable way to get JayBeams compiled. We will describe this first and then describe how to manually install all the dependencies.</p>
<h2>Running a Docker-based Build</h2>
<p>To compile using a Ubuntu 16.04 image, with <code>gcc</code>, using the default configuration use:</p>
<div class="fragment"><div class="line">https://github.com/coryan/jaybeams.git</div><div class="line">cd jaybeams</div><div class="line">LINUX_BUILD=yes DISTRO=ubuntu DISTRO_VERSION=16.04 CXX=g++ CC=gcc ./ci/build-linux.sh</div></div><!-- fragment --><p>That's it. This script will use your current checkout, install and build all the dependencies, and then build JayBeams.</p>
<p>The results of installing and building the dependencies are cached by the docker daemon, so your next build would be substantially faster. You can also try using a different compiler, e.g.:</p>
<div class="fragment"><div class="line">LINUX_BUILD=yes DISTRO=ubuntu DISTRO_VERSION=16.04 CXX=clang++ CC=clang \</div><div class="line">  ./ci/build-linux.sh</div></div><!-- fragment --><p>Or compile with different settings, e.g.:</p>
<div class="fragment"><div class="line">LINUX_BUILD=yes DISTRO=ubuntu DISTRO_VERSION=16.04 CXX=clang++ CC=clang \</div><div class="line">  CMAKE_FLAGS=&quot;-DCMAKE_BUILD_TYPE=Release&quot; ./ci/build-linux.sh</div></div><!-- fragment --><p>While this is fast enough for continuous integration builds, it rebuilds all the JayBeams code each time, for quick development you may want to install the dependencies in your workstation and compile from the command-line or within your IDE.</p>
<h2>Installing on Fedora 25</h2>
<p>We assume that you have superuser privileges in your workstation. These instructions are largely copied from the <code>ci/Dockerfile.fedora</code> file, if you find an error please let me <a href="https://github.com/coryan/jaybeams/issues">know</a>, and consult that file for possible workarounds.</p>
<h3>Installing the Developement Tools</h3>
<div class="fragment"><div class="line">sudo dnf makecache</div><div class="line">sudo dnf install -y autoconf autoconf-archive automake boost boost-devel boost-static bzip2-devel clang clinfo \</div><div class="line">  cmake compiler-rt curl doxygen fftw-devel findutils gcc-c++ git golang lcov libtool make lshw ocl-icd-devel \</div><div class="line">  opencl-headers openssl openssl-devel openssl-static patch pocl-devel pkgconfig python shtool sudo tar time \</div><div class="line">  unzip valgrind wget yaml-cpp-devel zlib-devel</div><div class="line">dnf clean all</div></div><!-- fragment --><h3>Installing Additional Packages</h3>
<h4>clFFT (FFT library for OpenCL)</h4>
<div class="fragment"><div class="line">mkdir /var/tmp/build-clFFT</div><div class="line">cd /var/tmp/build-clFFT</div><div class="line">wget -q https://github.com/clMathLibraries/clFFT/archive/v2.12.2.tar.gz</div><div class="line">tar -xf v2.12.2.tar.gz</div><div class="line">cd clFFT-2.12.2/src</div><div class="line">cmake -DCMAKE_INSTALL_PREFIX:PATH=/usr/local/clFFT-2.12.2 .</div><div class="line">make</div><div class="line">sudo make install</div><div class="line">cd</div><div class="line">/bin/rm -fr /var/tmp/build-clFFT</div><div class="line"># ... use this to avoid settint LD_LIBRARY_PATH everywhere ...</div><div class="line">echo /usr/local/clFFT-2.12.2/lib64 | sudo tee /etc/ld.so.conf.d/clfft-2.12.2.conf</div><div class="line">sudo ldconfig</div></div><!-- fragment --><h3>Boost.Compute (C++ wrappers for OpenCL)</h3>
<div class="fragment"><div class="line">wget -q https://github.com/boostorg/compute/archive/boost-1.62.0.tar.gz</div><div class="line">tar -xf boost-1.62.0.tar.gz</div><div class="line">cd compute-boost-1.62.0</div><div class="line">cmake . &amp;&amp; make &amp;&amp; make DESTDIR=staging install</div><div class="line">sudo cp -r staging/usr/local/include/compute/boost/compute.hpp /usr/include/boost/</div><div class="line">sudo cp -r staging/usr/local/include/compute/boost/compute/ /usr/include/boost/</div><div class="line">sudo sed -i &#39;/pragma message.*deprecated/d&#39; \</div><div class="line">  /usr/include/boost/type_traits/detail/template_arity_spec.hpp \</div><div class="line">  /usr/include/boost/type_traits/detail/bool_trait_def.hpp</div></div><!-- fragment --><h3>gRPC (a remote procedure call framework by Google)</h3>
<div class="fragment"><div class="line">mkdir /var/tmp/build-grpc</div><div class="line">cd /var/tmp/build-grpc</div><div class="line">git clone --depth 10 --branch v1.6.x https://github.com/grpc/grpc.git &amp;&amp; \</div><div class="line">  (cd /var/tmp/build-grpc/grpc/ &amp;&amp; \</div><div class="line">    git submodule update --init &amp;&amp; \</div><div class="line">    env LDXX=&quot;g++ -std=c++14&quot; LD=gcc CXX=&quot;g++ -std=c++14&quot; CC=gcc \</div><div class="line">      make &amp;&amp; \</div><div class="line">    env LDXX=&quot;g++ -std=c++14&quot; LD=gcc CXX=&quot;g++ -std=c++14&quot; CC=gcc \</div><div class="line">      sudo make install &amp;&amp; \</div><div class="line">    env LDXX=&quot;g++ -std=c++14&quot; LD=gcc CXX=&quot;g++ -std=c++14&quot; CC=gcc \</div><div class="line">      sudo make -C third_party/protobuf install &amp;&amp; \</div><div class="line">    echo /usr/local/lib &gt;/etc/ld.so.conf.d/local.conf &amp;&amp; ldconfig &amp;&amp; \</div><div class="line">    find /usr/local -type f -name &#39;*.la&#39; -exec rm -f {} \;)</div><div class="line">cd</div><div class="line">/bin/rm -fr /var/tmp/build-grpc</div></div><!-- fragment --><h3>etcd (a distributed lock service daemon)</h3>
<p>This is only used in certain integration tests, but you should install it anyway:</p>
<div class="fragment"><div class="line">mkdir /var/tmp/install-etcd</div><div class="line">cd /var/tmp/install-etcd</div><div class="line">wget -q https://github.com/coreos/etcd/releases/download/v3.2.1/etcd-v3.2.1-linux-amd64.tar.gz &amp;&amp; \</div><div class="line">  tar -xf etcd-v3.2.1-linux-amd64.tar.gz &amp;&amp; \</div><div class="line">  sudo cp etcd-v3.2.1-linux-amd64/etcd /usr/bin &amp;&amp; \</div><div class="line">  sudo cp etcd-v3.2.1-linux-amd64/etcdctl /usr/bin</div><div class="line">cd</div><div class="line">/bin/rm -fr /var/tmp/install-etcd</div></div><!-- fragment --><h3>Checkout the Code and Build</h3>
<p>This is the easy part:</p>
<div class="fragment"><div class="line">git clone https://github.com/coryan/jaybeams.git</div><div class="line">cd jaybeams</div><div class="line">mkdir build</div><div class="line">cd build</div><div class="line">cmake ..</div><div class="line">make</div></div><!-- fragment --><p>To run the tests use the <code>test</code> make target:</p>
<div class="fragment"><div class="line">make test</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
