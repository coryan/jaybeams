machine:
  environment:
    IMAGE: coryan/jaybeamsdev-fedora25
  timezone: America/New_York
  services:
    - docker

dependencies:
  pre:
    - sudo apt-get update && sudo apt-get install docker-engine
  overrides:
    - docker pull ${IMAGE?}
    - docker image inspect -f '{{ .Id }}' ${IMAGE?}:latest
    - ci/create-build-image.sh
    - docker image inspect -f '{{ .Id }}' ${IMAGE?}:tip

test:
  override:
    - docker run --rm -it --env CONFIGUREFLAGS="" --env CXX=clang++ --env CXXFLAGS="-O1 -g" --env VALGRIND="yes" --volume $PWD:$PWD --workdir $PWD ${IMAGE?}:tip ci/build-in-docker.sh
    - cat build/test-suite.log || echo "Could not print test logs"

general:
  branches:
    ignore:
      - gh-pages
    only:
      - develop # debug in develop before committing everybwhere.
